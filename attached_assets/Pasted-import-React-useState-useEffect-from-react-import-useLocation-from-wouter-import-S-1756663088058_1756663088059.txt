import React, { useState, useEffect } from "react";
import { useLocation } from "wouter";
import { SandraImages } from "../lib/sandra-images";
import { PortfolioSection } from "../components/portfolio-section";
import FreeTierSignup from "../components/free-tier-signup";
import WelcomeEditorial from "../components/welcome-editorial";
import { EmailCaptureModal } from "../components/email-capture-modal";
import { InlineEmailCapture } from "../components/inline-email-capture";
import { GlobalFooter } from "../components/global-footer";

export default function EditorialLanding() {
  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);
  const [selectedPlan] = useState('personal-brand-studio');
  const [, setLocation] = useLocation();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);

  // SEO Meta Tags and Performance Optimization
  useEffect(() => {
    document.title = "SSELFIE Studio - AI Personal Branding Platform | Transform Selfies Into Professional Photos";
    
    let metaDescription = document.querySelector('meta[name="description"]');
    if (!metaDescription) {
      metaDescription = document.createElement('meta');
      metaDescription.setAttribute('name', 'description');
      document.head.appendChild(metaDescription);
    }
    metaDescription.setAttribute('content', 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Your trained AI model, 100 monthly professional photos, Maya AI photographer.');
    
    const seoTags = [
      { name: 'keywords', content: 'AI personal branding, AI photographer, professional headshots AI, personal brand builder, selfie to professional photos, AI brand strategist, business launch platform, professional photos from selfies, AI personal brand coach, digital brand transformation' },
      { property: 'og:title', content: 'SSELFIE Studio - AI Personal Branding Platform | Professional Photos from Selfies' },
      { property: 'og:description', content: 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Your trained AI model, 100 monthly professional photos, Maya AI photographer.' },
      { property: 'og:type', content: 'website' },
      { property: 'og:url', content: window.location.href },
      { property: 'og:site_name', content: 'SSELFIE Studio' },
      { name: 'twitter:card', content: 'summary_large_image' },
      { name: 'twitter:title', content: 'SSELFIE Studio - AI Personal Branding Platform' },
      { name: 'twitter:description', content: 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Never pay for another photoshoot.' },
      { name: 'twitter:creator', content: '@sandra.social' },
      { name: 'author', content: 'Sandra Sigurjónsdóttir' },
      { name: 'robots', content: 'index, follow, max-image-preview:large' }
    ];
    
    seoTags.forEach(tag => {
      let existingTag = document.querySelector(`meta[${tag.property ? 'property' : 'name'}="${tag.property || tag.name}"]`);
      if (!existingTag) {
        existingTag = document.createElement('meta');
        existingTag.setAttribute(tag.property ? 'property' : 'name', tag.property || tag.name!);
        document.head.appendChild(existingTag);
      }
      existingTag.setAttribute('content', tag.content);
    });

    const structuredData = {
      "@context": "https://schema.org",
      "@type": ["WebPage", "SoftwareApplication"],
      "name": "SSELFIE Studio",
      "description": "AI-powered personal branding platform that transforms selfies into professional business photos",
      "url": window.location.href,
      "author": {
        "@type": "Person",
        "name": "Sandra Sigurjónsdóttir",
        "url": "https://instagram.com/sandra.social"
      },
      "applicationCategory": "BusinessApplication",
      "offers": [
        {
          "@type": "Offer",
          "name": "Personal Brand Studio",
          "price": "47",
          "priceCurrency": "EUR",
          "description": "Your trained personal AI model + 100 monthly professional photos + Maya AI photographer access + personal brand photo gallery"
        }
      ]
    };

    let structuredDataScript = document.querySelector('script[type="application/ld+json"]');
    if (!structuredDataScript) {
      structuredDataScript = document.createElement('script');
      (structuredDataScript as HTMLScriptElement).type = 'application/ld+json';
      document.head.appendChild(structuredDataScript);
    }
    structuredDataScript.textContent = JSON.stringify(structuredData);
  }, []);

  useEffect(() => {
    const handleScroll = () => {
      const isScrolled = window.scrollY > 50;
      setScrolled(isScrolled);
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const handleGetStarted = (plan: string = 'personal-brand-studio') => {
    localStorage.setItem('selectedPlan', plan);
    const emailCaptured = localStorage.getItem('emailCaptured');
    
    if (emailCaptured) {
      setLocation('/simple-checkout');
    } else {
      setIsEmailModalOpen(true);
    }
  };

  return (
    <div className="min-h-screen bg-white">
      {/* Navigation - Editorial Magazine Style */}
      <nav className={`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${
        scrolled ? 'bg-white border-b border-gray-200' : 'bg-transparent'
      }`}>
        <div className="max-w-[1600px] mx-auto px-6 lg:px-12 py-6">
          <div className="flex items-center justify-between">
            <button 
              onClick={() => setLocation("/")}
              className={`font-serif text-3xl font-extralight tracking-[0.15em] transition-colors duration-300 ${
                scrolled ? 'text-black' : 'text-white'
              } hover:opacity-60`}
            >
              SSELFIE
            </button>
            
            <div className="hidden md:flex items-center gap-12">
              <button 
                onClick={() => setLocation("/about")}
                className={`text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                  scrolled ? 'text-gray-600 hover:text-black' : 'text-white/80 hover:text-white'
                }`}
              >
                About
              </button>
              <button 
                onClick={() => setLocation("/pricing")}
                className={`text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                  scrolled ? 'text-gray-600 hover:text-black' : 'text-white/80 hover:text-white'
                }`}
              >
                Pricing
              </button>
              <button 
                onClick={() => setLocation("/blog")}
                className={`text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                  scrolled ? 'text-gray-600 hover:text-black' : 'text-white/80 hover:text-white'
                }`}
              >
                Blog
              </button>
              <button
                onClick={() => setLocation('/login')}
                className={`text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                  scrolled ? 'text-gray-600 hover:text-black' : 'text-white/80 hover:text-white'
                }`}
              >
                Login
              </button>
              <button 
                onClick={() => setLocation("/contact")}
                className={`text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                  scrolled ? 'text-gray-600 hover:text-black' : 'text-white/80 hover:text-white'
                }`}
              >
                Contact
              </button>
            </div>
            
            {/* Mobile Menu Button */}
            <button
              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
              className={`md:hidden text-[11px] tracking-[0.3em] uppercase transition-colors duration-300 ${
                scrolled ? 'text-black' : 'text-white'
              }`}
            >
              {mobileMenuOpen ? 'Close' : 'Menu'}
            </button>
            
            <button
              onClick={() => handleGetStarted()}
              className={`hidden md:block px-8 py-3 text-[11px] tracking-[0.3em] uppercase transition-all duration-300 ${
                scrolled 
                  ? 'bg-black text-white hover:bg-gray-900' 
                  : 'bg-white text-black hover:bg-gray-100'
              }`}
            >
              Start €47
            </button>
          </div>
        </div>
      </nav>

      {/* Mobile Menu - Full Screen Editorial */}
      {mobileMenuOpen && (
        <div className="fixed inset-0 z-40 bg-white">
          <div className="flex flex-col items-center justify-center min-h-screen space-y-10">
            <button 
              onClick={() => { setLocation("/about"); setMobileMenuOpen(false); }}
              className="text-sm tracking-[0.4em] uppercase text-black hover:opacity-60 transition-opacity"
            >
              About
            </button>
            <button 
              onClick={() => { setLocation("/pricing"); setMobileMenuOpen(false); }}
              className="text-sm tracking-[0.4em] uppercase text-black hover:opacity-60 transition-opacity"
            >
              Pricing
            </button>
            <button 
              onClick={() => { setLocation("/blog"); setMobileMenuOpen(false); }}
              className="text-sm tracking-[0.4em] uppercase text-black hover:opacity-60 transition-opacity"
            >
              Blog
            </button>
            <button
              onClick={() => { setLocation('/login'); setMobileMenuOpen(false); }}
              className="text-sm tracking-[0.4em] uppercase text-black hover:opacity-60 transition-opacity"
            >
              Login
            </button>
            <button 
              onClick={() => { setLocation("/contact"); setMobileMenuOpen(false); }}
              className="text-sm tracking-[0.4em] uppercase text-black hover:opacity-60 transition-opacity"
            >
              Contact
            </button>
            <button
              onClick={() => { handleGetStarted(); setMobileMenuOpen(false); }}
              className="px-10 py-4 bg-black text-white text-xs uppercase tracking-[0.3em] hover:bg-gray-900 transition-colors mt-8"
            >
              Start €47
            </button>
          </div>
        </div>
      )}

      {/* Hero Section - Editorial Magazine Cover Style */}
      <section className="relative min-h-screen flex items-center">
        <div className="absolute inset-0 bg-black">
          <img
            src={SandraImages.hero.homepage}
            alt="Sandra Sigurjónsdóttir - SSELFIE Studio Founder"
            className="w-full h-full object-cover opacity-50"
            loading="eager"
            fetchPriority="high"
          />
        </div>
        
        <div className="relative z-10 w-full">
          <div className="max-w-[1600px] mx-auto px-6 lg:px-12">
            <div className="grid grid-cols-12 gap-6">
              <div className="col-span-12 lg:col-span-10 lg:col-start-2">
                <p className="text-[10px] tracking-[0.5em] uppercase text-white/60 mb-8">
                  It starts with your selfies
                </p>
                
                <h1 className="font-serif font-extralight leading-[0.85]">
                  <span className="block text-[clamp(4rem,15vw,12rem)] text-white mb-4">
                    SSELFIE
                  </span>
                  <span className="block text-[clamp(2rem,7vw,6rem)] text-white/80 italic ml-[5%]">
                    studio
                  </span>
                </h1>
                
                <div className="mt-16 max-w-md">
                  <p className="text-white/70 text-sm leading-relaxed mb-8">
                    Your personal AI photographer. Never pay for another photoshoot.
                  </p>
                  <button
                    onClick={() => handleGetStarted()}
                    className="text-[11px] tracking-[0.4em] uppercase text-white border-b border-white/30 pb-2 hover:border-white transition-all duration-300"
                  >
                    Begin Your Journey
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Editorial Quote Section */}
      <section className="py-32 bg-gray-50">
        <div className="max-w-[1200px] mx-auto px-6 lg:px-12">
          <div className="grid grid-cols-12 gap-6">
            <div className="col-span-12 lg:col-span-8 lg:col-start-3">
              <blockquote className="font-serif text-[clamp(1.5rem,4vw,3rem)] font-light italic leading-[1.2] text-gray-900">
                "I went from teaching women how to take better selfies to building AI that creates perfect ones for them."
              </blockquote>
              <div className="mt-8">
                <p className="text-[11px] tracking-[0.4em] uppercase text-gray-500">
                  — Sandra Sigurjónsdóttir, Founder
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Features Section - Editorial Grid */}
      <section className="py-24 bg-white">
        <div className="max-w-[1600px] mx-auto px-6 lg:px-12">
          <div className="grid grid-cols-12 gap-8">
            {/* Large Editorial Text */}
            <div className="col-span-12 lg:col-span-4">
              <p className="text-[11px] tracking-[0.4em] uppercase text-gray-500 mb-8">
                The Method
              </p>
              <h2 className="font-serif text-[clamp(2.5rem,5vw,4rem)] font-extralight leading-[0.9] mb-8">
                Transform<br/>
                selfies into<br/>
                professional<br/>
                brand photos
              </h2>
            </div>
            
            {/* Feature Cards - Magazine Layout */}
            <div className="col-span-12 lg:col-span-8">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-0">
                {/* AI Photoshoot Feature */}
                <div className="border-b border-r-0 md:border-r border-gray-200 p-8 lg:p-12 group hover:bg-black hover:text-white transition-all duration-500">
                  <div className="text-[80px] font-serif font-extralight opacity-10 group-hover:opacity-5">01</div>
                  <h3 className="font-serif text-2xl font-light mb-4 -mt-12">AI Photoshoot</h3>
                  <p className="text-sm leading-relaxed opacity-80">
                    Upload your phone selfies, get photos that look like you hired a fancy photographer. No studio required.
                  </p>
                </div>
                
                {/* Maya AI Feature */}
                <div className="border-b border-gray-200 p-8 lg:p-12 group hover:bg-black hover:text-white transition-all duration-500">
                  <div className="text-[80px] font-serif font-extralight opacity-10 group-hover:opacity-5">02</div>
                  <h3 className="font-serif text-2xl font-light mb-4 -mt-12">Maya AI Photographer</h3>
                  <p className="text-sm leading-relaxed opacity-80">
                    Chat with Maya to create perfect brand photoshoots. She knows exactly how to style you.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Portfolio Section - Magazine Style Grid */}
      <section className="py-24 bg-gray-50">
        <div className="max-w-[1600px] mx-auto px-6 lg:px-12">
          <div className="grid grid-cols-12 gap-8 mb-16">
            <div className="col-span-12 lg:col-span-6">
              <p className="text-[11px] tracking-[0.4em] uppercase text-gray-500 mb-4">
                My AI Portfolio
              </p>
              <h2 className="font-serif text-[clamp(2rem,4vw,3.5rem)] font-extralight leading-[0.9]">
                Real results from<br/>my personal brand
              </h2>
            </div>
          </div>
          
          <PortfolioSection />
        </div>
      </section>

      {/* Pricing Section - Editorial Minimalist */}
      <section className="py-32 bg-black text-white">
        <div className="max-w-[1200px] mx-auto px-6 lg:px-12">
          <div className="grid grid-cols-12 gap-8">
            <div className="col-span-12 lg:col-span-10 lg:col-start-2">
              <div className="text-center mb-20">
                <p className="text-[11px] tracking-[0.4em] uppercase text-white/60 mb-8">
                  Investment
                </p>
                <h2 className="font-serif text-[clamp(3rem,7vw,6rem)] font-extralight leading-[0.9]">
                  €47
                </h2>
                <p className="text-[11px] tracking-[0.4em] uppercase text-white/60 mt-4">
                  Per Month
                </p>
              </div>
              
              <div className="max-w-2xl mx-auto">
                <h3 className="font-serif text-3xl font-light mb-12 text-center">
                  Personal Brand Studio
                </h3>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 mb-16">
                  <div className="flex items-start">
                    <span className="text-white/40 mr-4 text-2xl font-light">•</span>
                    <span className="text-sm">Your trained personal AI model</span>
                  </div>
                  <div className="flex items-start">
                    <span className="text-white/40 mr-4 text-2xl font-light">•</span>
                    <span className="text-sm">100 monthly professional photos</span>
                  </div>
                  <div className="flex items-start">
                    <span className="text-white/40 mr-4 text-2xl font-light">•</span>
                    <span className="text-sm">Maya AI photographer access</span>
                  </div>
                  <div className="flex items-start">
                    <span className="text-white/40 mr-4 text-2xl font-light">•</span>
                    <span className="text-sm">Personal brand photo gallery</span>
                  </div>
                </div>
                
                <div className="text-center">
                  <button
                    onClick={() => handleGetStarted()}
                    className="px-12 py-5 bg-white text-black text-[11px] tracking-[0.4em] uppercase hover:bg-gray-100 transition-all duration-300"
                  >
                    Start Your Journey
                  </button>
                  <p className="text-xs text-white/40 mt-6">
                    Cancel anytime. No photographer required.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Testimonial Section - Editorial Style */}
      <section className="py-32 bg-white">
        <div className="max-w-[1400px] mx-auto px-6 lg:px-12">
          <div className="grid grid-cols-12 gap-8">
            <div className="col-span-12 lg:col-span-2">
              <p className="text-[11px] tracking-[0.4em] uppercase text-gray-500 mb-8 lg:mb-0">
                Testimonial
              </p>
            </div>
            <div className="col-span-12 lg:col-span-8">
              <blockquote className="font-serif text-[clamp(1.5rem,3vw,2.5rem)] font-light italic leading-[1.3] text-gray-900 mb-8">
                "I thought I knew what I was doing, but Sandra's system completely changed how I show up online. 
                The AI photos don't look AI - they look like me, but the version of me I've always wanted to be."
              </blockquote>
              <p className="text-[11px] tracking-[0.4em] uppercase text-gray-500">
                — Elena M., Life Coach
              </p>
            </div>
          </div>
        </div>
      </section>

      {/* Final Quote - Full Bleed Editorial */}
      <section className="relative py-40 bg-gray-50">
        <div className="max-w-[1200px] mx-auto px-6 lg:px-12 text-center">
          <blockquote className="font-serif text-[clamp(2rem,5vw,4rem)] font-extralight italic leading-[1.1] text-gray-900 mb-16">
            "When you show up as her?<br />
            Everything changes."
          </blockquote>
          
          <button
            onClick={() => handleGetStarted()}
            className="px-12 py-5 bg-black text-white text-[11px] tracking-[0.4em] uppercase hover:bg-gray-900 transition-all duration-300"
          >
            Begin Today €47
          </button>
        </div>
      </section>

      {/* Global Footer */}
      <GlobalFooter />

      {/* Email Capture Modal */}
      <EmailCaptureModal
        isOpen={isEmailModalOpen}
        onClose={() => setIsEmailModalOpen(false)}
        plan={selectedPlan}
        onEmailCaptured={(email) => {
          console.log('Email captured:', email);
        }}
      />
    </div>
  );
}