import React, { useState, useEffect } from "react";
import { useLocation } from "wouter";
import { SandraImages } from "../lib/sandra-images";
import { PortfolioSection } from "../components/portfolio-section";
import FreeTierSignup from "../components/free-tier-signup";
import WelcomeEditorial from "../components/welcome-editorial";
import { EmailCaptureModal } from "../components/email-capture-modal";
import { InlineEmailCapture } from "../components/inline-email-capture";
import { GlobalFooter } from "../components/global-footer";

export default function EditorialLanding() {
  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);
  const [selectedPlan] = useState('personal-brand-studio');
  const [, setLocation] = useLocation();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);

  // SEO Meta Tags and Performance Optimization
  useEffect(() => {
    document.title = "SSELFIE Studio - AI Personal Branding Platform | Transform Selfies Into Professional Photos";
    
    // Update or create meta description with rich keywords
    let metaDescription = document.querySelector('meta[name="description"]');
    if (!metaDescription) {
      metaDescription = document.createElement('meta');
      metaDescription.setAttribute('name', 'description');
      document.head.appendChild(metaDescription);
    }
    metaDescription.setAttribute('content', 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Your trained AI model, 100 monthly professional photos, Maya AI photographer.');
    
    // Add comprehensive SEO meta tags
    const seoTags = [
      { name: 'keywords', content: 'AI personal branding, AI photographer, professional headshots AI, personal brand builder, selfie to professional photos, AI brand strategist, business launch platform, professional photos from selfies, AI personal brand coach, digital brand transformation' },
      { property: 'og:title', content: 'SSELFIE Studio - AI Personal Branding Platform | Professional Photos from Selfies' },
      { property: 'og:description', content: 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Your trained AI model, 100 monthly professional photos, Maya AI photographer.' },
      { property: 'og:type', content: 'website' },
      { property: 'og:url', content: window.location.href },
      { property: 'og:site_name', content: 'SSELFIE Studio' },
      { name: 'twitter:card', content: 'summary_large_image' },
      { name: 'twitter:title', content: 'SSELFIE Studio - AI Personal Branding Platform' },
      { name: 'twitter:description', content: 'Transform selfies into professional brand photos with AI. Personal Brand Studio €47/month - Never pay for another photoshoot.' },
      { name: 'twitter:creator', content: '@sandra.social' },
      { name: 'author', content: 'Sandra Sigurjónsdóttir' },
      { name: 'robots', content: 'index, follow, max-image-preview:large' }
    ];
    
    seoTags.forEach(tag => {
      let existingTag = document.querySelector(`meta[${tag.property ? 'property' : 'name'}="${tag.property || tag.name}"]`);
      if (!existingTag) {
        existingTag = document.createElement('meta');
        existingTag.setAttribute(tag.property ? 'property' : 'name', tag.property || tag.name!);
        document.head.appendChild(existingTag);
      }
      existingTag.setAttribute('content', tag.content);
    });

    // Add structured data for better search results
    const structuredData = {
      "@context": "https://schema.org",
      "@type": ["WebPage", "SoftwareApplication"],
      "name": "SSELFIE Studio",
      "description": "AI-powered personal branding platform that transforms selfies into professional business photos",
      "url": window.location.href,
      "author": {
        "@type": "Person",
        "name": "Sandra Sigurjónsdóttir",
        "url": "https://instagram.com/sandra.social"
      },
      "applicationCategory": "BusinessApplication",
      "offers": [
        {
          "@type": "Offer",
          "name": "Personal Brand Studio",
          "price": "47",
          "priceCurrency": "EUR",
          "description": "Your trained personal AI model + 100 monthly professional photos + Maya AI photographer access + personal brand photo gallery"
        }
      ]
    };

    let structuredDataScript = document.querySelector('script[type="application/ld+json"]');
    if (!structuredDataScript) {
      structuredDataScript = document.createElement('script');
      (structuredDataScript as HTMLScriptElement).type = 'application/ld+json';
      document.head.appendChild(structuredDataScript);
    }
    structuredDataScript.textContent = JSON.stringify(structuredData);
  }, []);

  useEffect(() => {
    const handleScroll = () => {
      const isScrolled = window.scrollY > 50;
      setScrolled(isScrolled);
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const handleGetStarted = (plan: string = 'personal-brand-studio') => {
    // Store the selected plan
    localStorage.setItem('selectedPlan', plan);
    
    // Check if email already captured
    const emailCaptured = localStorage.getItem('emailCaptured');
    
    if (emailCaptured) {
      // Email already captured, proceed to checkout for both plans
      setLocation('/simple-checkout');
    } else {
      // Show email capture modal first
      setIsEmailModalOpen(true);
    }
  };

  return (
    <div className="min-h-screen bg-white">
      {/* EDITORIAL NAVIGATION - Transparent Always */}
      <nav className={`fixed top-0 left-0 right-0 z-50 transition-all duration-700 ${
        scrolled ? 'backdrop-blur-md' : ''
      }`}>
        <div className="absolute inset-0 bg-gradient-to-b from-black/40 to-transparent pointer-events-none"></div>
        <div className="relative max-w-[1800px] mx-auto px-8 lg:px-16 py-8">
          <div className="flex items-center justify-between">
            {/* Logo - Editorial Typography */}
            <button 
              onClick={() => setLocation("/")}
              className="group"
            >
              <div className="flex items-baseline gap-2">
                <span className="font-serif text-4xl font-thin text-white tracking-[0.2em] group-hover:tracking-[0.25em] transition-all duration-500">
                  SSELFIE
                </span>
                <span className="text-[10px] tracking-[0.4em] text-white/50 uppercase">
                  Studio
                </span>
              </div>
            </button>
            
            {/* Desktop Navigation - Editorial Spacing */}
            <div className="hidden lg:flex items-center gap-16">
              <button 
                onClick={() => setLocation("/about")}
                className="text-[11px] font-light tracking-[0.35em] uppercase text-white/70 hover:text-white transition-all duration-300"
              >
                About
              </button>
              <button 
                onClick={() => setLocation("/pricing")}
                className="text-[11px] font-light tracking-[0.35em] uppercase text-white/70 hover:text-white transition-all duration-300"
              >
                Pricing
              </button>
              <button 
                onClick={() => setLocation("/blog")}
                className="text-[11px] font-light tracking-[0.35em] uppercase text-white/70 hover:text-white transition-all duration-300"
              >
                Blog
              </button>
              <button
                onClick={() => setLocation('/login')}
                className="text-[11px] font-light tracking-[0.35em] uppercase text-white/70 hover:text-white transition-all duration-300"
              >
                Login
              </button>
              <button 
                onClick={() => setLocation("/contact")}
                className="text-[11px] font-light tracking-[0.35em] uppercase text-white/70 hover:text-white transition-all duration-300"
              >
                Contact
              </button>
            </div>
            
            {/* CTA Button - Editorial Style */}
            <button
              onClick={() => handleGetStarted()}
              className="hidden lg:block relative overflow-hidden group"
            >
              <div className="relative px-10 py-4 border border-white/20 backdrop-blur-sm">
                <span className="relative z-10 text-[11px] tracking-[0.4em] uppercase text-white font-light">
                  Start €47
                </span>
                <div className="absolute inset-0 bg-white transform translate-y-full group-hover:translate-y-0 transition-transform duration-500"></div>
                <span className="absolute inset-0 flex items-center justify-center text-[11px] tracking-[0.4em] uppercase text-black font-light transform translate-y-full group-hover:translate-y-0 transition-transform duration-500">
                  Start €47
                </span>
              </div>
            </button>
            
            {/* Mobile Menu Button */}
            <button
              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
              className="lg:hidden text-[11px] tracking-[0.4em] uppercase text-white font-light"
            >
              {mobileMenuOpen ? 'Close' : 'Menu'}
            </button>
          </div>
        </div>
      </nav>

      {/* Mobile Menu - Editorial Fullscreen */}
      {mobileMenuOpen && (
        <div className="fixed inset-0 z-[60] bg-black">
          <div className="flex flex-col items-center justify-center min-h-screen">
            <div className="space-y-8">
              <button 
                onClick={() => { setLocation("/about"); setMobileMenuOpen(false); }}
                className="block text-center text-2xl font-serif font-thin text-white hover:italic transition-all duration-300"
              >
                About
              </button>
              <button 
                onClick={() => { setLocation("/pricing"); setMobileMenuOpen(false); }}
                className="block text-center text-2xl font-serif font-thin text-white hover:italic transition-all duration-300"
              >
                Pricing
              </button>
              <button 
                onClick={() => { setLocation("/blog"); setMobileMenuOpen(false); }}
                className="block text-center text-2xl font-serif font-thin text-white hover:italic transition-all duration-300"
              >
                Blog
              </button>
              <button
                onClick={() => { setLocation('/login'); setMobileMenuOpen(false); }}
                className="block text-center text-2xl font-serif font-thin text-white hover:italic transition-all duration-300"
              >
                Login
              </button>
              <button 
                onClick={() => { setLocation("/contact"); setMobileMenuOpen(false); }}
                className="block text-center text-2xl font-serif font-thin text-white hover:italic transition-all duration-300"
              >
                Contact
              </button>
            </div>
            <button
              onClick={() => { handleGetStarted(); setMobileMenuOpen(false); }}
              className="mt-16 px-12 py-5 border border-white text-white text-[11px] tracking-[0.4em] uppercase hover:bg-white hover:text-black transition-all duration-300"
            >
              Begin Your Journey
            </button>
          </div>
        </div>
      )}

      {/* HERO - Magazine Cover Style */}
      <section className="relative h-screen flex items-end">
        <div className="absolute inset-0">
          <img
            src={SandraImages.hero.homepage}
            alt="Sandra Sigurjónsdóttir - SSELFIE Studio Founder transforming personal branding with AI"
            className="w-full h-full object-cover"
            loading="eager"
            fetchPriority="high"
          />
          <div className="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent"></div>
        </div>
        
        <div className="relative z-10 w-full pb-16 lg:pb-24">
          <div className="max-w-[1800px] mx-auto px-8 lg:px-16">
            <div className="grid grid-cols-12 gap-4">
              <div className="col-span-12 lg:col-span-10">
                {/* Editorial Headline Layout */}
                <div className="mb-12">
                  <h1 className="font-serif">
                    <span className="block text-[clamp(5rem,18vw,16rem)] leading-[0.8] font-thin text-white tracking-[0.1em]">
                      SSELFIE
                    </span>
                    <span className="block text-[clamp(2rem,8vw,7rem)] leading-[0.8] font-thin text-white/60 italic -mt-4 ml-[10%]">
                      studio
                    </span>
                  </h1>
                </div>
                
                {/* Editorial Tagline */}
                <div className="max-w-xl">
                  <p className="text-[11px] tracking-[0.5em] uppercase text-white/50 mb-6">
                    It starts with your selfies
                  </p>
                  <p className="text-lg font-light text-white/80 leading-relaxed mb-8">
                    Your personal AI photographer. Transform selfies into professional brand photos.
                  </p>
                  <button
                    onClick={() => handleGetStarted()}
                    className="group inline-flex items-center gap-8"
                  >
                    <span className="text-[11px] tracking-[0.4em] uppercase text-white">
                      Begin Your Journey
                    </span>
                    <span className="w-12 h-[1px] bg-white/30 group-hover:w-24 group-hover:bg-white transition-all duration-500"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* EDITORIAL QUOTE - Magazine Pull Quote */}
      <section className="py-32 bg-white">
        <div className="max-w-[1600px] mx-auto px-8 lg:px-16">
          <div className="grid grid-cols-12 gap-8">
            <div className="col-span-12 lg:col-span-2 lg:col-start-2">
              <div className="h-[1px] w-full bg-gray-200 mb-8"></div>
              <p className="text-[10px] tracking-[0.5em] uppercase text-gray-400">
                The Journey
              </p>
            </div>
            <div className="col-span-12 lg:col-span-7">
              <blockquote className="font-serif text-[clamp(2rem,5vw,4.5rem)] leading-[0.95] font-thin text-black">
                <span className="italic">I went from</span> teaching women how to take better selfies <span className="italic">to building AI</span> that creates perfect ones <span className="italic">for them.</span>
              </blockquote>
              <div className="mt-12 flex items-center gap-6">
                <div className="w-20 h-[1px] bg-gray-300"></div>
                <p className="text-[10px] tracking-[0.5em] uppercase text-gray-500">
                  Sandra Sigurjónsdóttir
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* WELCOME EDITORIAL COMPONENT */}
      <WelcomeEditorial />

      {/* FEATURES - Editorial Spread */}
      <section className="py-32 bg-black text-white">
        <div className="max-w-[1800px] mx-auto px-8 lg:px-16">
          <div className="grid grid-cols-12 gap-8 mb-24">
            <div className="col-span-12 lg:col-span-8 lg:col-start-3">
              <p className="text-[10px] tracking-[0.5em] uppercase text-white/40 mb-8">
                The Method
              </p>
              <h2 className="font-serif text-[clamp(3rem,7vw,6rem)] leading-[0.85] font-thin">
                Transform selfies<br/>
                <span className="italic text-white/60">into professional</span><br/>
                brand photos
              </h2>
            </div>
          </div>
          
          {/* Feature Cards - Magazine Grid */}
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-0">
            {/* AI Photoshoot */}
            <div className="border border-white/10 p-12 lg:p-16 group hover:bg-white hover:text-black transition-all duration-700">
              <div className="flex justify-between items-start mb-8">
                <span className="text-[100px] font-serif font-thin opacity-10 leading-none">01</span>
                <span className="text-[10px] tracking-[0.4em] uppercase opacity-50 mt-4">
                  Feature
                </span>
              </div>
              <h3 className="font-serif text-3xl font-thin mb-6 -mt-20">
                AI Photoshoot
              </h3>
              <p className="text-sm font-light leading-relaxed opacity-70 group-hover:opacity-100">
                Upload your phone selfies, get photos that look like you hired a fancy photographer. No studio required.
              </p>
            </div>
            
            {/* Maya AI */}
            <div className="border border-white/10 p-12 lg:p-16 group hover:bg-white hover:text-black transition-all duration-700">
              <div className="flex justify-between items-start mb-8">
                <span className="text-[100px] font-serif font-thin opacity-10 leading-none">02</span>
                <span className="text-[10px] tracking-[0.4em] uppercase opacity-50 mt-4">
                  Feature
                </span>
              </div>
              <h3 className="font-serif text-3xl font-thin mb-6 -mt-20">
                Maya AI Photographer
              </h3>
              <p className="text-sm font-light leading-relaxed opacity-70 group-hover:opacity-100">
                Chat with Maya to create perfect brand photoshoots. She knows exactly how to style you and generate photos that look professional.
              </p>
            </div>
          </div>
        </div>
      </section>

      {/* PORTFOLIO SECTION */}
      <section className="py-32 bg-gray-50">
        <div className="max-w-[1800px] mx-auto px-8 lg:px-16">
          <div className="grid grid-cols-12 gap-8 mb-20">
            <div className="col-span-12 lg:col-span-6 lg:col-start-2">
              <p className="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-6">
                Portfolio
              </p>
              <h2 className="font-serif text-[clamp(3rem,6vw,5rem)] leading-[0.9] font-thin text-black">
                Real results from<br/>
                <span className="italic">my personal brand</span>
              </h2>
            </div>
          </div>
          
          <PortfolioSection />
        </div>
      </section>

      {/* PRICING - Editorial Minimalism */}
      <section className="relative py-32 bg-white">
        <div className="max-w-[1400px] mx-auto px-8 lg:px-16">
          <div className="grid grid-cols-12 gap-8">
            {/* Left Side - Price Statement */}
            <div className="col-span-12 lg:col-span-5">
              <div className="sticky top-32">
                <p className="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-8">
                  Investment
                </p>
                <div className="mb-8">
                  <span className="font-serif text-[clamp(6rem,12vw,10rem)] leading-[0.8] font-thin">€47</span>
                  <span className="text-sm font-light text-gray-500 ml-4">per month</span>
                </div>
                <button
                  onClick={() => handleGetStarted()}
                  className="group"
                >
                  <span className="text-[11px] tracking-[0.4em] uppercase text-black border-b border-gray-300 pb-2 group-hover:border-black transition-all duration-300">
                    Start Your Journey
                  </span>
                </button>
              </div>
            </div>
            
            {/* Right Side - Details */}
            <div className="col-span-12 lg:col-span-6 lg:col-start-7">
              <h3 className="font-serif text-4xl font-thin mb-12">
                Personal Brand<br/>
                <span className="italic text-gray-400">Studio</span>
              </h3>
              
              <div className="space-y-8 mb-12">
                <div className="flex items-start gap-6 group">
                  <span className="text-3xl font-thin text-gray-200 group-hover:text-black transition-colors">•</span>
                  <div>
                    <h4 className="text-sm font-light mb-2">Your trained personal AI model</h4>
                    <p className="text-xs text-gray-500">Personalized to your unique features</p>
                  </div>
                </div>
                <div className="flex items-start gap-6 group">
                  <span className="text-3xl font-thin text-gray-200 group-hover:text-black transition-colors">•</span>
                  <div>
                    <h4 className="text-sm font-light mb-2">100 monthly professional photos</h4>
                    <p className="text-xs text-gray-500">Fresh content every month</p>
                  </div>
                </div>
                <div className="flex items-start gap-6 group">
                  <span className="text-3xl font-thin text-gray-200 group-hover:text-black transition-colors">•</span>
                  <div>
                    <h4 className="text-sm font-light mb-2">Maya AI photographer access</h4>
                    <p className="text-xs text-gray-500">Your personal styling assistant</p>
                  </div>
                </div>
                <div className="flex items-start gap-6 group">
                  <span className="text-3xl font-thin text-gray-200 group-hover:text-black transition-colors">•</span>
                  <div>
                    <h4 className="text-sm font-light mb-2">Personal brand photo gallery</h4>
                    <p className="text-xs text-gray-500">Organized and ready to use</p>
                  </div>
                </div>
              </div>
              
              <p className="text-xs text-gray-400">
                Cancel anytime. No photographer required.
              </p>
            </div>
          </div>
        </div>
      </section>

      {/* TESTIMONIAL - Editorial Style */}
      <section className="py-32 bg-gray-50">
        <div className="max-w-[1600px] mx-auto px-8 lg:px-16">
          <div className="grid grid-cols-12 gap-8">
            <div className="col-span-12 lg:col-span-8 lg:col-start-3">
              <div className="text-center">
                <p className="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-12">
                  Testimonial
                </p>
                <blockquote className="font-serif text-[clamp(1.5rem,4vw,3rem)] leading-[1.2] font-thin italic text-gray-900 mb-12">
                  "I thought I knew what I was doing, but Sandra's system completely changed how I show up online. 
                  The AI photos don't look AI - they look like me, but the version of me I've always wanted to be."
                </blockquote>
                <div className="flex items-center justify-center gap-6">
                  <div className="w-20 h-[1px] bg-gray-300"></div>
                  <p className="text-[10px] tracking-[0.5em] uppercase text-gray-500">
                    Elena M., Life Coach
                  </p>
                  <div className="w-20 h-[1px] bg-gray-300"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* FINAL CTA - Magazine Closing */}
      <section className="relative py-40 bg-black text-white overflow-hidden">
        <div className="absolute inset-0 opacity-20">
          <div className="absolute top-0 right-0 w-[800px] h-[800px] border border-white/10 rounded-full -translate-y-1/2 translate-x-1/2"></div>
          <div className="absolute bottom-0 left-0 w-[600px] h-[600px] border border-white/10 rounded-full translate-y-1/2 -translate-x-1/2"></div>
        </div>
        
        <div className="relative max-w-[1200px] mx-auto px-8 lg:px-16 text-center">
          <blockquote className="font-serif text-[clamp(2.5rem,6vw,5rem)] leading-[0.9] font-thin italic mb-16">
            "When you show up as her?<br />
            <span className="not-italic text-white/60">Everything changes."</span>
          </blockquote>
          
          <button
            onClick={() => handleGetStarted()}
            className="relative group overflow-hidden"
          >
            <div className="px-14 py-6 border border-white/20">
              <span className="relative z-10 text-[11px] tracking-[0.5em] uppercase font-light">
                Begin Today €47
              </span>
              <div className="absolute inset-0 bg-white transform scale-x-0 group-hover:scale-x-100 transition-transform duration-700 origin-left"></div>
              <span className="absolute inset-0 flex items-center justify-center text-[11px] tracking-[0.5em] uppercase text-black font-light opacity-0 group-hover:opacity-100 transition-opacity duration-700 delay-300">
                Begin Today €47
              </span>
            </div>
          </button>
        </div>
      </section>

      {/* Global Footer */}
      <GlobalFooter />

      {/* Email Capture Modal */}
      <EmailCaptureModal
        isOpen={isEmailModalOpen}
        onClose={() => setIsEmailModalOpen(false)}
        plan={selectedPlan}
        onEmailCaptured={(email) => {
          console.log('Email captured:', email);
        }}
      />
    </div>
  );
}